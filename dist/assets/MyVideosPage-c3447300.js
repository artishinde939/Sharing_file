import{r as i,b as F,j as e,Q as D}from"./index-53f28f78.js";import{u as I,p as W,a as S,o as E,b as R,d as U,N as z,U as A}from"./Upload-e5c8f783.js";import{L as O}from"./Loader-c7aba96f.js";const P=({handleSelectedVideo:x,updatedList:m})=>{const[h,w]=i.useState([]),[d,p]=i.useState(!0),[n,y]=i.useState(!1),[u]=F(),b=u.user.myVideos;return i.useEffect(()=>{(async()=>{y(!0);const r=await Promise.all(b.map(async l=>await S(l)));r[0]===null&&r.shift(),w(r),y(!1)})()},[b,m]),e.jsxs("div",{className:"w-1/2 bg-[#0F121FF5] max-sm:w-full",children:[e.jsxs("div",{className:"mx-6 flex justify-between items-baseline mt-3",children:[e.jsx("p",{className:"text-white",children:"My Videos"}),e.jsxs("button",{id:"dropdownDefaultButton","data-dropdown-toggle":"dropdown",className:"text-white focus:outline-none font-medium rounded-lg text-sm px-4 pb-2.5 pt-1 text-center inline-flex items-center",type:"button",onClick:()=>p(a=>!a),children:["Recent",e.jsx("svg",{className:"w-4 h-4 ml-2","aria-hidden":"true",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),n?e.jsx(O,{}):d?e.jsx("ul",{className:"sm:grid sm:grid-cols-[repeat(auto-fit,minmax(200px,1fr))] sm:gap-4",children:h.map(a=>e.jsx("li",{className:"flex items-center max-sm:mb-3",onClick:()=>{x(a._id)},children:e.jsxs("div",{className:"relative w-5/6 ml-6 h-auto",children:[e.jsxs("video",{className:"w-full h-full object-cover rounded hover:border-[#C4B4F8] hover:border-4",children:[e.jsx("source",{src:a.video,type:"video/mp4"}),"Your browser does not support the video tag."]}),e.jsx("img",{src:I,className:"absolute bottom-2 right-2 rounded-full max-h-6 max-w-6"}),e.jsx("img",{src:W,className:"absolute top-2 right-2 rounded-full max-h-6 max-w-6"}),e.jsx("div",{style:{maxWidth:"50%",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word"},className:"absolute left-1 bottom-12 text-white font-bold text-justify text-xs mt-1",children:a.title}),e.jsxs("div",{className:"absolute bottom-2 left-2 flex justify-start items-baseline",children:[e.jsx("div",{className:"ml-2 text-gray-200 text-xs mt-1",children:a.date}),e.jsxs("div",{className:"ml-2 text-gray-200 text-xs px-1 py",children:[a.duration," Mins"]}),e.jsxs("div",{className:"ml-2 text-gray-200 text-xs mt-1",children:[a.views," Views"]})]})]})},a._id))}):null]})},_=({selectedVideo:x,handleUpdatedList:m,handleSelectedVideo:h})=>{const[w,d]=i.useState(!1),p=()=>{window.innerWidth<640?d(!0):d(!1)},[n,y]=i.useState({}),[u,b]=i.useState({}),[a]=F(),r=a.user._id,l=x||a.user.myVideos[0],g=t=>D.success(t),f=t=>D.error(t),[c,v]=i.useState({title:"",description:"",category:"",visibility:""}),[C,j]=i.useState({Category:"",Visibility:""}),N=t=>{v(s=>({...s,[t.target.name]:t.target.value}))},V=t=>{y(s=>({...s,[t]:!s[t]}))},L=(t,s)=>{j(o=>({...o,[t]:s})),v(o=>({...o,[t.toLowerCase()]:s})),V(t)},k=async t=>{if(!t||!r)return e.jsx("p",{className:"text-center font-extrabold text-4xl",children:"User has no videos to edit"});try{const s=await S(t);b(s),v({title:s.title,description:s.description,category:s.category,visibility:s.visibility}),j({Category:s.category,Visibility:s.visibility})}catch(s){f(s.message)}};i.useEffect(()=>{k(l),window.addEventListener("resize",p)},[l,r,x,a.user.myVideos.length]);const B=async t=>{t.preventDefault();const s=new FormData;s.append("title",c.title),s.append("category",c.category),s.append("description",c.description),s.append("visibility",c.visibility);try{const o=await R(r,l,c);g(o),m()}catch(o){f(o.message)}},M=async()=>{try{const t=await U(r,l);m();const s=a.user.myVideos.indexOf(l);s!==-1&&a.user.myVideos.splice(s,1);const o=a.user.myVideos[0];h(o),k(o),g(t)}catch(t){f(t.message)}};return e.jsx("div",{className:" max-sm:w-full w-1/2 bg-[#0F121FF5]",children:!l||!r?e.jsx("p",{className:"text-center font-extrabold text-4xl",children:"User has no videos to edit"}):e.jsxs("div",{children:[e.jsx("div",{className:" min-w-full aspect-w-16 h-44",children:e.jsx("video",{src:u.video,className:"w-full h-full object-cover"})}),e.jsxs("form",{action:"#",method:"POST",onSubmit:B,encType:"application/json",children:[e.jsxs("div",{className:"md:flex justify-between p-2",children:[e.jsx("div",{style:{maxWidth:"50%",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word"},children:e.jsx("input",{name:"title",type:"text",className:" text-xl font-bold bg-[#0F121FF5] text-white max-w-fit focus:outline-none",value:c.title,onChange:N})}),e.jsxs("div",{className:"flex items-baseline",children:[e.jsx("div",{className:"sm:ml-2 text-gray-200 text-xs mt-1",children:u.date}),e.jsxs("div",{className:"ml-2 text-gray-200 text-xs px-1 py",children:[u.duration," Mins"]}),e.jsxs("div",{className:"ml-2 text-gray-200 text-xs mt-1 mr-3 ",children:[u.views," Views"]})]})]}),e.jsx("hr",{className:" mx-2 border-gray-700"}),e.jsxs("div",{className:" py-1 px-2",children:[e.jsx("p",{className:"text-white underline",children:"Description:"}),e.jsx("textarea",{type:"text",name:"description",value:c.description,onChange:N,className:" text-sm focus:outline-none bg-[#0F121FF5] min-w-full text-white h-10 placeholder:text-sm placeholder:text-gray-500",placeholder:"Description"})]}),e.jsx("hr",{className:" mx-2 border-gray-700"}),e.jsx("div",{className:"md:flex justify-around py-1",children:E.map(t=>e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 pl-6",children:t.title}),e.jsxs("button",{id:"dropdownDefaultButton","data-dropdown-toggle":"dropdown",className:"text-white focus:outline-none font-medium rounded-lg text-sm px-4 pb-2.5 pt-1 text-center inline-flex items-center",type:"button",onClick:()=>V(t.title),children:[C[t.title]||t.title,e.jsx("svg",{className:"w-4 h-4 ml-2","aria-hidden":"true",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),n[t.title]&&t.list&&e.jsx("div",{id:"dropdown",className:"z-50 absolute bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700",children:e.jsx("ul",{className:"py-2 text-sm text-gray-700 dark:text-gray-200","aria-labelledby":"dropdownDefaultButton",children:t.list.map(s=>e.jsx("li",{children:e.jsx("p",{className:"block px-4 py-1 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white",onClick:()=>{L(t.title,s)},children:s})},s))})})]},t.title))}),e.jsx("hr",{className:" mx-2 border-gray-700"}),e.jsxs("div",{className:" mt-10 mb-3 h-fit md:flex justify-between",children:[e.jsx("button",{type:"button",className:" mx-4 mt-6 hover:bg-red-800 text-white font-bold py-2 px-12 bg-red-500 rounded-[28px]",onClick:M,children:"Delete"}),e.jsx("button",{type:"submit",className:" mt-6 mx-4 text-white font-bold py-2 px-12 bg-[#C4B4F8] hover:bg-violet-500 rounded-[28px]",children:"Save"})]})]})]})})},q=()=>{const[x,m]=i.useState(""),[h,w]=i.useState(0),d=n=>{m(n)},p=()=>{w(n=>n+1)};return e.jsxs("div",{children:[e.jsx(z,{}),e.jsxs("div",{className:"flex relative max-sm:flex-col",children:[e.jsx(P,{handleSelectedVideo:d,updatedList:h}),e.jsx(_,{handleSelectedVideo:d,selectedVideo:x,handleUpdatedList:p}),e.jsx(A,{})]})]})};export{q as default};
